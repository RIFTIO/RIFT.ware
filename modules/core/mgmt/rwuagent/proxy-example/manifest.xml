<?xml version="1.0" ?>
<manifest xmlns="http://riftio.com/ns/riftware-1.0/rw-manifest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://riftio.com/ns/riftware-1.0/rw-manifest ./rw-manifest.xsd">
  

  <bootstrap-phase>
    <rwmgmt>
      <northbound-listing>mgmtagt_tbed_schemas.txt</northbound-listing>
      <northbound-listing>confd_nb_schema_list.txt</northbound-listing>
      <agent-mode>CONFD</agent-mode>
      <persist-dir-name>persist.riftware</persist-dir-name>
    </rwmgmt>
    <ip-addrs-list>
      <ip-addr>127.0.0.1</ip-addr>
    </ip-addrs-list>
    <rwtasklet>
      <plugin-name>rwinit-c</plugin-name>
    </rwtasklet>
    <rwtrace>
      <enable>true</enable>
      <level>5</level>
      <filter/>
    </rwtrace>
    <log>
      <enable>true</enable>
      <severity>6</severity>
      <bootstrap-time>30</bootstrap-time>
      <console-severity>3</console-severity>
    </log>
    <zookeeper>
      <master-ip>127.0.0.1</master-ip>
      <unique-ports>false</unique-ports>
      <zake>true</zake>
    </zookeeper>
    <serf>
      <start>false</start>
    </serf>
    <rwvm>
      <instances>
        <component-name>msgbroker</component-name>
        <config-ready>true</config-ready>
        <recovery-action>FAILCRITICAL</recovery-action>
        <data-storetype>NOSTORE</data-storetype>
      </instances>
      <instances>
        <component-name>dtsrouter</component-name>
        <config-ready>true</config-ready>
        <recovery-action>FAILCRITICAL</recovery-action>
        <data-storetype>NOSTORE</data-storetype>
      </instances>
    </rwvm>
    <rwsecurity>
      <use-ssl>true</use-ssl>
      <cert>/net/gluon/localdisk/speriasa/master/etc/ssl/current.cert</cert>
      <key>/net/gluon/localdisk/speriasa/master/etc/ssl/current.key</key>
    </rwsecurity>
  </bootstrap-phase>
  <init-phase>
    <environment>
      <python-variable>vm_ip_address = '127.0.0.1'</python-variable>
      <python-variable>rw_component_name = 'VM.MGMT'</python-variable>
      <python-variable>instance_id = 2</python-variable>
      <python-variable>component_type = 'rwvm'</python-variable>
      <component-name>$python(rw_component_name)</component-name>
      <component-type>$python(rw_component_type)</component-type>
      <instance-id>$python(instance_id)</instance-id>
      <active-component>
        <python-variable>rw_component_name = 'VM.MGMT'</python-variable>
        <python-variable>component_type = 'rwvm'</python-variable>
        <python-variable>instance_id = 2</python-variable>
        <python-variable>parent_id = 'master-1'</python-variable>
        <component-name>$python(rw_component_name)</component-name>
        <component-type>$python(component_type)</component-type>
        <instance-id>$python(instance_id)</instance-id>
        <parent-id>$python(parent_id)</parent-id>
      </active-component>
    </environment>
    <settings>
      <rwtrace/>
      <rwmsg>
        <multi-broker>
          <enable>true</enable>
        </multi-broker>
      </rwmsg>
      <rwdtsrouter>
        <multi-dtsrouter>
          <enable>true</enable>
        </multi-dtsrouter>
      </rwdtsrouter>
      <rwvcs>
        <collapse-each-rwvm>true</collapse-each-rwvm>
        <collapse-each-rwprocess>true</collapse-each-rwprocess>
      </rwvcs>
      <mgmt-agent>
        <netconf-trace>ENABLE</netconf-trace>
      </mgmt-agent>
    </settings>
  </init-phase>
  <inventory>
    <component>
      <component-name>rw.colony</component-name>
      <component-type>RWCOLLECTION</component-type>
      <rwcollection>
        <collection-type>rwcolony</collection-type>
        <event-list>
          <event>
            <name>onentry</name>
            <action>
              <name>Start VM.MGMT for rw.colony</name>
              <start>
                <python-variable>vm_ip_address = '127.0.0.1'</python-variable>
                <component-name>VM.MGMT</component-name>
                <instance-id>2</instance-id>
                <ip-address>127.0.0.1</ip-address>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
              </start>
            </action>
          </event>
        </event-list>
      </rwcollection>
    </component>
    <component>
      <component-name>VM.MGMT</component-name>
      <component-type>RWVM</component-type>
      <rwvm>
        <leader>true</leader>
        <event-list>
          <event>
            <name>onentry</name>
            <action>
              <name>Start the rw.colony</name>
              <start>
                <component-name>rw.colony</component-name>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
              </start>
            </action>
            <action>
              <name>Start the RW.Proc_1.Restconf</name>
              <start>
                <component-name>RW.Proc_1.Restconf</component-name>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
              </start>
            </action>
            <action>
              <name>Start the RW.CLI</name>
              <start>
                <component-name>RW.CLI</component-name>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
                <mode-active>true</mode-active>
              </start>
            </action>
            <action>
              <name>Start the RW.Proc_2.uAgent</name>
              <start>
                <component-name>RW.Proc_2.uAgent</component-name>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
              </start>
            </action>
            <action>
              <name>Start the logd</name>
              <start>
                <component-name>logd</component-name>
                <config-ready>true</config-ready>
                <recovery-action>FAILCRITICAL</recovery-action>
                <data-storetype>NOSTORE</data-storetype>
                <mode-active>true</mode-active>
              </start>
            </action>
          </event>
        </event-list>
      </rwvm>
    </component>
    <component>
      <component-name>RW.Proc_1.Restconf</component-name>
      <component-type>RWPROC</component-type>
      <rwproc>
        <tasklet>
          <name>Start RW.Restconf for RW.Proc_1.Restconf</name>
          <component-name>RW.Restconf</component-name>
          <config-ready>true</config-ready>
          <recovery-action>FAILCRITICAL</recovery-action>
          <data-storetype>NOSTORE</data-storetype>
          <mode-active>true</mode-active>
        </tasklet>
      </rwproc>
    </component>
    <component>
      <component-name>RW.Restconf</component-name>
      <component-type>RWTASKLET</component-type>
      <rwtasklet>
        <plugin-directory>./usr/lib/rift/plugins/restconf</plugin-directory>
        <plugin-name>restconf</plugin-name>
      </rwtasklet>
    </component>
    <component>
      <component-name>RW.CLI</component-name>
      <component-type>PROC</component-type>
      <native-proc>
        <exe-path>./usr/bin/rwcli</exe-path>
        <args> --username admin  --passwd admin  --netconf_host 127.0.0.1 --netconf_port 2022</args>
        <interactive/>
      </native-proc>
    </component>
    <component>
      <component-name>RW.Proc_2.uAgent</component-name>
      <component-type>RWPROC</component-type>
      <rwproc>
        <tasklet>
          <name>Start RW.uAgent for RW.Proc_2.uAgent</name>
          <component-name>RW.uAgent</component-name>
          <config-ready>true</config-ready>
          <recovery-action>FAILCRITICAL</recovery-action>
          <data-storetype>NOSTORE</data-storetype>
          <mode-active>true</mode-active>
          <python-variable>cmdargs_str = '--confd-proto AF_INET --confd-ip 127.0.0.1'</python-variable>
        </tasklet>
      </rwproc>
    </component>
    <component>
      <component-name>RW.uAgent</component-name>
      <component-type>RWTASKLET</component-type>
      <rwtasklet>
        <plugin-directory>./usr/lib/rift/plugins/rwuagent-c</plugin-directory>
        <plugin-name>rwuagent-c</plugin-name>
      </rwtasklet>
    </component>
    <component>
      <component-name>logd</component-name>
      <component-type>RWTASKLET</component-type>
      <rwtasklet>
        <plugin-directory>./usr/lib/rift/plugins/rwlogd-c</plugin-directory>
        <plugin-name>rwlogd-c</plugin-name>
      </rwtasklet>
    </component>
    <component>
      <component-name>msgbroker</component-name>
      <component-type>RWTASKLET</component-type>
      <rwtasklet>
        <plugin-directory>./usr/lib/rift/plugins/rwmsgbroker-c</plugin-directory>
        <plugin-name>rwmsgbroker-c</plugin-name>
      </rwtasklet>
    </component>
    <component>
      <component-name>dtsrouter</component-name>
      <component-type>RWTASKLET</component-type>
      <rwtasklet>
        <plugin-directory>./usr/lib/rift/plugins/rwdtsrouter-c</plugin-directory>
        <plugin-name>rwdtsrouter-c</plugin-name>
      </rwtasklet>
    </component>
  </inventory>
</manifest>
